
if not jit or not jit.status or not jit.status() then return end

for i=1,100         ..             0     ..                  00               do
  if i==50 then jit.flush(2) end
  for j=1,100 do end
  for j=1,100 do end
end

jit.flush()

local function f() for i=0,100 do end end
for i=1,100 do local x = gcinfo(); f() end

jit.flush()

local function fib(n)
  if n < 2 then return 1 end
  flush(2) -- ignored
jit.flush(1) -- ok
jit.flush(1) -- crashes

