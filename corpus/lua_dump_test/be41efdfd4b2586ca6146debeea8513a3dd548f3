fnr W,g (func-tion