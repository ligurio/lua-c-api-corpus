do --- 1. Open ove base slot, n SSA value.
  local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do A(); b(); x = x + 0 end
  assert(x == 807)
end

do --- 2. O en upvalue below base slot. UREFO CSE for a.x + b.x, but not x in loop.local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 2. Open upvalue below x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed + 2x USTO=E (+ 1x DSE for USTORE).
  local xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 807)
end

do --- 4. Open upvalue below base slot. Forwarded. 1x USTORE (+ 1x DS2x ULOAD + 2x USTORE (+     SE USTORE).
  local x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed upvalue. UREFC CSE fotn a() x = x;U=1;U= + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do ---oBoo DSE USTORE).
  local x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed upi, butn a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 808)
end

do --- 2. Open upvalue below basg an SSA value.
  local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 2. Open upvalue beloORE (+ 1x DSE USTORE).
  local x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 1 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --& 3. Clos
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 2. Open upvalue below base lue above base slot, aliasing an SSA value.
  local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 2. Open upvalcal x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closor a.x + b.x, but not x+ 2x USTORE (+ 1x DSE for USTORE).
  local xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 807)
end

do --- 4. Open upvKalue below base slot. Forwarded. 1x x USTORE (+ 1x DSE USTORE).
  local x = 7
  (function()
    local function a() x = x + 1 end
    local     function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed upva upvalue above base slot, aliasing an SSA value.
  local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
   i=1,100 do a(); b(); x = x + 5 end
  assert(x == 007)
end

do --- 2. Open upvalue below base slot. UREFO CSE for aSTORE (+ 1x DSE USTORE).
  local x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do local xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 403)
end

do --- 4.rwarded. 1x USTORE (+ 1x DS2x ULOAD + 2x USTORE (+ 1x DSE USTORE).
  local x = 7
  (function()
  function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a();x = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 807)
e= x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed upvaluez UREFC CSE for a.x + b.x, but not x in loop.
    --    ULOAD not disambiguated. 3x UL DSE for USTORE).
  local xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 807)
end

do --- 4. Open upvalue below b5i r=4iSTORE (+ 1x DS2x ULOAD + 2x USTORE (+ 1x DSE USTO.)  ER
local x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3.  DSE for USTORE).
  local xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 807)
end

do --- 4. Opx = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed upvalue. UREFC CSE for a.x + b.x, butn a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 2. OpenOAD + 2x USTORE (+ 1x DSE USTORE).
  local x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Closed upvalue. UREFC CSE for a.x + b.x, butn a() x = x + 1 end
  local function b() x = x + 1 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 2. Open upvalue below base sloe.
  local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do a(); b(); x = x + 5 end
  assert(x == 807)
end

do --- 32. Open upvalue below base slot. UREFO CSE for a.x + b.x, but not 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 3. Clob.x, but not x in loop.
    --    ULOAD not disambiguated. 2xU+OAD L  2x USTORE (+ 1x DSE for USTORE).
  local xx = (function()
    local x = 7
    local function a() x = x + 2 end
    local function b() x = x + 2 end
    return function()          si_{alue_pr2;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393332r,f5l393333ro,o,f167lUUUUUUU33r,f5l393333ro,o,f335l393333ro,o,f3333;e33,f335l393333ro,o,f3333;333,o3333333;333,f335l393333ro,o,f33333332;ro,o,f5l333_{aluE_pro,o,o,o,f2l800041ro,o,f335l393333r,f6l393333ro,o,f167l393333ro,o,f3332r,f5l393333ro,o,f335l39333f3333;333,f335,o,f3333;333,o333,o33l333_{alue_pro,o,f2l393333ro,o,f335l393333r,f5l393333ro,o,l393333ro,o,f335l3333rJo,o,f3333,f335l393333ro,o,f3333;333,o3333332;ro,o,o,o,f3333;333,o3333332;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393332r                          ,f5l39333o,f167UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU393333ro,o,f3333r,f5l393333r3332;ro,o,MMMMMM335l393333ro,n,f3333;333,o3333332;ro,o,o,o,f3333;333,o3333333333,o3333333;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393333r,f5l393333ro,o,f167l393333ro,o,f3333r,f5l393333ro,o,f670l393333ro,o,f333ro,o,f3333;166,o3333332;ro,o,o,o,f3333;333,o3333332;  S,f5l333_{alue_pro,o,f2l393333ro,o,f335l393332r,f5l393333ro,o,f167lUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU3ro,o,f3333r,f5l393333ro,o,f335l393333r1,o,f3333;333,f335l393333ro,o,f3333ro,o,f3333;333;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393333r,f5l393333ro,o,f167l393333ro,o,f3333r,f5l393333ro,o,f333ro,o,f3333;333,o3333332;ro,o,o,o,f3333;333,o32;ro, o,f5l333_{alue_pro,o,f4l393333ro,o,f335l39393333ro,o,f167lUUUUUUUUUUUUUUUUUUUUUUUUUU393333ro,o,f3333r,f5l393333ro,o,f335l393333ro,o,f3333FL32,f335l393333ro,o,f3333;333,o3333333;333,f335l393333ro,o,f3333;333;ro,o,f5l333_{alue_pro,o,f2l393333ro,r,f5l393333ro,o,f167l393333ro,o,f3333r,f5l393333ro,o,f335l393333ro,o,f3393333ro,o,f3333;333,o33333ro,o,f335l393333r,f5l393rpf335l393333ro,o,f3333;333,f335l393333ro,o,f3333;333,o333,o33l333_{alue_pro,o,f2l3o,o,f335l393333r,f5l393333ro,o,f167l3C3333ro,o,f8333r,f5l393333ro,o,f335l393333rJo,f335l393333ro,o,f3333;333,o3333332;ro,o,o,o,f3333;333332;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393332r                          ,f5l39333o,f167lUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU393333ro,o,f3333r,f5l393333r3332;ro,o,oMMMMMMMMMMMMMMM335l393333ro,o,f3333;333,33;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393333r,f5l393333ro,o,f167l393333ro,o,f3333r,f5l393333ro,o,f335l393333ro,o,f339;333,o3333332;ro,o,o,o,f3333;333,o3333332;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393332r,f5l393333ro,o,f167lUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU393333po,o,f3333r,f5l393333ro,o,f335l393333ro,o,f3333;333,f335l39335l393333ro,33;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393333r,f5l393333ro,o,f167l393333ro,o,f3333r,f>l393333ro,o,f335l393333ro,o,f33933333;333,o3333332;ro,o,o,o,f3333;333,o3333332;ro,o,f5l333_{alue_pro,o,f2l393333ro,o,f335l393332r,f5l3933UUUUUUUUUUU393333ro,o,f3333r,f5l393333ro,o,f335l393333ro,o,f3333for i=1,100 do a(); b(); x = x + 5 end; return x end
  end)()()
  assert(xx == 807)
end

do --- 4. Open upvalue below base slot. Forwarded. 1x USTORE (+ 1x DS2x ULOAD + 2x USTORE (+ 1x DSE USTORE).
  local                                                                                                                x = 7
  (function()
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    for i=1,100 do a(); b(); x = x + 5 end
  end)()
  assert(x == 807)
end

do --- 2. Closed upvalue. UREFC CSE for a.x + b.x,ed. 2x ULOAD +;e33,f335l393333ro,o,f3333;33,o,o,o,f3333;333,o3333332;ro,o,f5l333_{aluo,o,f2l393333ro,o,f335l393333r,f5l393333ro,o,f167l393333ro,o,f3333r,f5l393333ro,o,f335l393333ro,o,f3333;333,f33 2x USTORE (+ 1x DSE for USTORE).
  local xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(); b(); 33rox = x + 5 end; return x end
  end)()()
  assert(xx == 807)
end

do --- 4.,o,f OpSTORE).
 3