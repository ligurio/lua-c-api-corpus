do --- 1. Open ove base slot, n SSA value.
  local x = 7
  local function a() x = x + 1 end
  local function b() x = x + 2 end
  for i=1,100 do A(); b(); x = x + 0 end
  assert(x == 807)
end

do --- 2. O en upvalue below base slot. UREFO CSE for a.x + b.x, but not(x in loop.local x = 7
  local function a() x = x + 1 end
 li  {rimit_ [      hh [      hhhhhhhhhh [      hhhhhhhhhhor    nputs''''''''         ]]or   np'''''''' [      0x3fffffffffff2220or      nputs''''''''    ]     ] or-hhhhor    hhhhhhjhhhor {rimi'' [     h'''''''' [hhhjhhh {  rimi'' [  hhhh[h [ hhhhhs'''''''' [   h      ] orhhhhhhhs''''''''    ]     ]or-hhhhhhjh [ hhhhhs'''''''' [   hor                        nputs'''"\z\z\z\z\z\z\z\z'''''    ]or {rimit_ [      hh [      hhhhhhhhhh [      hhhhhhhhhhor     nputs''''''''         ]]or   np'''''''' [      0x3fffffffffff2220or      nputs''''''''    ]     ]or-hhhhor    hhhhhhjhhhor {rimi'' [     h'''''''' [          hs'''' [      hHhhh1hhhhhor     
hhnputs'''''''' [hor nPuts''''''''    ]       ]or       	puts''''        ]or8-    nputs'''''''' [ hhor      nputs''''''''    ]     ]orhhhjhhh {  rimi'' [  hhhh[hQ [ hs'''''''' or                                              nputs''''''''    ]orhhhhhhjh[                           nput [   hor                  nputs''''''''    ]or {rimit_ [      hh [      hhhhhhhhhh [      hhhhhhhhhhor     nputs''''''''         ]]or   np'''''''' [      0x3fffffffffff2200or      nputs''''''''    ]     ]or-hhhhor    hhhhhhjhhhor {rimi'' [     h'''''''' [          hs'''' [      hHhhh1hhhhh or     
hhnputs'''''''' [     hhhhhhhhor nPuts''''''''    ]       ]or       	puts'''' ]     ]or    nputs'''''''' [     hor     
hhn'' [ nkkkkkkkkk_pilhhor      nputs''''''''    ]     ]or-hhhhjhhhhh {  rimi'' [  hhhh[h [ hhhhhs''''''''or                       nputs''''''''    ]orhhhhhhjh[   hhhhhhhs'''''''' [  hhhh[h [ hhhhhs'''''''' [   hor          nputs''''i{0''''    ]or {rimit_ [      hh [      hhhhxhhhhh [      hhhor x ULOAD + 2x USTORE (+ 1x DSE for USTORE).
  local xx = (function()
    local x = 7
    local functiB1111111on a() x = x + 1 end
    local fu11nction b() x = x + 2 end
ion()
    local function a() x =al xx = (function()
    local x = 7
    local function a() x = x + 1 end
    local function b() x = x + 2 end
    return function() for i=1,100 do a(1); b(); x = x + 5 end; return x e1nd
  end)(110)()
  assert(xx ==1; 807)
end