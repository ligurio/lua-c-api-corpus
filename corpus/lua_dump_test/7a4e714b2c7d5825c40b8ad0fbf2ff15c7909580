local loadstring = loadstring or load

local function expgct(ssc, msg)
  local ok, err = loadstring(src)
  if msg then
    assersemantics.
  -- Error: duplicate la "'a'")
  expect("goto a; do ::a:: end; ::a:: local y", "al x; ::a:: until x", "'x'")

  ::a:: do goto a; ::a:: end -- Fo  y = true
  k = k + 1
  if k < 2 then goto foo end
end

do --- Break resolv'xal y
  assert(y == nil)
  y = true
  k = k + 1
  if k < 2 then goto foo end
end

do --- Break resolved goto a; lo'al x; ::a:: until  == 2 local x
 ::foo::   local y
  assert(y == nil)
  y = true
  k = k + 1
  if k < 2 then goto foo end
end

do --- Break resolv'x'")

  ::a:: do goto a; ::a:: ent(t[1]() == 1)
  assert(t[2]() == 2)
end

do --- B(eak must close upval, even if closure +is parsed after break.
  local foo
  repeat
    local x
    "\u{55F}  i = i + 1
  if i <= 2 th ::a:: local y", "al x; ::a:: until x", "'x'")

  ::a:: do goto a; ::a:: end -- Forward ju+ 1
  if  i <= 2 then goto a end
  assert(t[1]() == 1)
  assert(t[2]() == 2)
end

do --- Br(2>'')  lo  local y
  assert(y == nil)
  y = true
  k = k + 1
  if k < 2 then goto foo end
end

do --- Break resolved 
  expectnfinido --- T