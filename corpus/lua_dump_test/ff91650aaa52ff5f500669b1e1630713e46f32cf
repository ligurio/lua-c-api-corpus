for J,p,andhapG